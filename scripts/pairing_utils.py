import montgomery as monty
import fp2

# r = 36x**4 + 36x**3 + 18x**2 + 6x + 1
# t = 6x**2 + 1
# x = 4965661367192848881
# s = 6x + 2 -> s = 29793968203157093288
S_NAF  = [0, 0, 0, 1, 0, 1, 0, -1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, -1, 0, 
 0, 0, 1, 0, -1, 0, 0, 0, 0, -1, 0, 0, 1, 0, -1, 0, 0, 1, 0, 0, 0, 0, 
 0, -1, 0, 0, -1, 0, 1, 0, -1, 0, 0, 0, -1, 0, -1, 0, 0, 0, 1, 0, -1, 0, 1]
TWISTED_CURVE_COEFFS = (monty.into(19485874751759354771024239261021720505790618469301721065564631296452457478373), monty.into(266929791119991161246907387137283842545076965332900288569378510910307636690))

def is_in_curve(x, y):
    x = monty.out_of(x)
    y = monty.out_of(y)

    N = 21888242871839275222246405745257275088696311157297823662689037894645226208583
    a = y ** 2 % N
    b = x ** 3 % N
    b = (b + 3) % N
    return a == b

def is_in_twisted_curve(x0, x1, y0, y1):    
    b = fp2.exp(x0, x1, 3)
    b = fp2.add(*b, *TWISTED_CURVE_COEFFS)
    c = fp2.exp(y0, y1, 2)
    return b == c
